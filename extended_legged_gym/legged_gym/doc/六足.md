
---

# ElSpider Air Robot Tasks

## Environment Setup

```bash
conda activate diffuseloco
```

---

## BasePoseAdapt ElSpiderAir

**简短解释：学习机体姿态（base pose）的自适应，使机器人能在狭窄/复杂空间中自动调整俯仰、横滚与高度，实现避障能力。**

Train ElSpider Air with base pose adaptation for collision avoidance.

**Training Commands:**

```bash
python legged_gym/scripts/train.py --task=el_mini_base_pose_adapt --num_envs=4096 --resume --headless
python legged_gym/scripts/play.py --task=el_mini_base_pose_adapt --num_envs=48 --checkpoint=-1
```

**Test Base Pose Control:**

```bash
python legged_gym/scripts/train.py --task=el_mini_base_pose_ctrl --num_envs=48
```

---

## ElSpiderAir Flat Terrain

**简短解释：训练基础步态与速度跟踪，是所有高级任务（rough、rollout、traj opt）的基础核心模型。**

**Training Epoch:** ~300

**Training Profile:**

* 70 epoch: velocity tracking reward grows up
* 160 epoch: enter reward stage 1
* 300 epoch: walking good

**Training Epoch:** ~500 (Actuator Net Disabled)

**Training Profile:**

* 100 epoch: velocity tracking reward grows up
* 250 epoch: enter reward stage 1
* 500 epoch: walking good

```bash
python legged_gym/scripts/train.py --task=elspider_air_flat --num_envs=6144 --resume --headless
python legged_gym/scripts/play.py --task=elspider_air_flat --num_envs=48 --checkpoint=-1  --load_run=Mar13_19-58-56_ --resume

#第一次训练去掉--resume
python3 /home/hithcat/Code/tools/PegasusFlow/extended_legged_gym/legged_gym/legged_gym/scripts/train.py \
    --task=elspider_air_flat \
    --sim_device cuda \
    --rl_device cuda \
    --graphics_device_id 0 \
    --num_envs 6144 \
    --max_iterations 300 \
    --headless

python3 /home/hithcat/Code/tools/PegasusFlow/extended_legged_gym/legged_gym/legged_gym/scripts/play.py --task=elspider_air_flat --num_envs=9 --checkpoint=-1  --load_run=Nov16_19-06-35_  --resume
```

---

## ElSpiderAir Batch Rollout

**简短解释：通过大规模批量 rollout 训练，提高步态稳定性、泛化能力，并为轨迹优化（trajectory opt）提供高质量 rollout。**

**Test Commands:**

```bash
python legged_gym/tests/test_batch_rollout_env.py --task=elspider_air_batch_rollout --num_envs=10

python legged_gym/tests/test_play_batch_rollout_env.py --task=elspider_air_batch_rollout --num_envs=10 --checkpoint=-1

python legged_gym/tests/test_play_batch_rollout_env.py --task=elspider_air_batch_rollout_flat --num_envs=10 --checkpoint=-1
```

Train ElSpider Air with batch rollout capability for trajectory optimization.

**Training Epoch:** ~500

**Training Profile (Actuator Net Disabled):**

* **Plane, 6144 Envs**

  * 150 epoch: velocity tracking reward grows up
  * 250 epoch: enter reward stage 1
  * 500 epoch: walking good

  ![alt text](imgs/elspider_air_batch_rollout_rew.png)
  ![alt text](imgs/elspider_air_batch_rollout_linvel.png)

* **Confined, 4096 Envs**

  * ? epoch: velocity tracking reward grows up
  * ? epoch: enter reward stage 1
  * ? epoch: walking good

```bash
python legged_gym/scripts/train.py --task=elspider_air_batch_rollout --num_envs=4096 --resume --headless
python legged_gym/scripts/play.py --task=elspider_air_batch_rollout --num_envs=32 --checkpoint=-1
```

---

## ElSpiderAir Batch Rollout Flat

**简短解释：无感知输入（no perception）的批量 rollout 平地版本，用于测试轨迹优化与 rollout 机制的稳定性。**

Train ElSpider Air with batch rollout capability on flat terrain (without perception features).

**Training Profile:**
6144 envs

![alt text](imgs/elspider_air_batch_rollout_flat_rew.png)
![alt text](imgs/elspider_air_batch_rollout_flat_linvel.png)

```bash
python legged_gym/scripts/train.py --task=elspider_air_batch_rollout_flat --num_envs=6144 --resume --headless
python legged_gym/scripts/play.py --task=elspider_air_batch_rollout_flat --num_envs=32 --checkpoint=-1
```

---

## ElSpiderAir Trajectory Gradient Sampling

**简短解释：利用梯度采样进行未来轨迹优化，使机器人具备更高动态与更精确的轨迹控制能力。**

Train ElSpider Air with gradient sampling for trajectory optimization.

**Test Commands:**

```bash
python legged_gym/tests/test_play_batch_rollout_env.py --task=elspider_air_traj_grad_sampling --num_envs=10 --checkpoint=-1
```

**Rollout:**

```bash
python legged_gym/scripts/train.py --task=elspider_air_traj_grad_sampling --num_envs=6144 --resume --headless
python legged_gym/scripts/play.py --task=elspider_air_traj_grad_sampling --num_envs=32 --checkpoint=-1
```

---

## Pose ElSpiderAir Flat

**简短解释：训练机器人维持稳定姿态（roll/pitch/yaw），为悬空控制与足端控制提供基础能力。**

Train ElSpider Air for pose control on flat terrain.

```bash
python legged_gym/scripts/train.py --task=pose_elspider_air_flat --num_envs=6144 --resume --headless
python legged_gym/scripts/play.py --task=pose_elspider_air_flat --num_envs=48 --checkpoint=-1
```

---

## FootTrack ElSpiderAir

### Hang Up Mode

**简短解释：悬空模式下训练足端轨迹控制，用于检查 IK 和腿部控制逻辑是否正确。**

```bash
python legged_gym/scripts/train.py --task=foot_track_elspider_air_hang --num_envs=6144 --resume --headless
python legged_gym/scripts/play.py --task=foot_track_elspider_air_hang --num_envs=48 --checkpoint=-1
```

### On Ground Mode

**简短解释：落地模式下训练足端轨迹 + 地面接触控制，用于精准步态或足端任务。**

```bash
python legged_gym/scripts/train.py --task=foot_track_elspider_air_flat --num_envs=6144 --resume --headless
python legged_gym/scripts/play.py --task=foot_track_elspider_air_flat --num_envs=48 --checkpoint=-1
```

---

## ElSpiderAir Rough Terrain

**简短解释：从平地迁移到随机/复杂地形，训练机器人在高度变化、坑洞、台阶上的强鲁棒行走能力。**

**Training Tip:**
IMPORTANT

1. Pretrain model on flat terrain to learn correct gait.
2. Use the pretrained model to train on rough terrain.

**Training Epoch:** ~500

**Training Profile:**

* 100 epoch: velocity tracking reward starts to grow up
* 100-500 epoch: terrain level grows up, rew_ang_vel~0.19, rew_lin_vel~0.57

```bash
python legged_gym/scripts/train.py --task=elspider_air_rough --num_envs=4096 --resume --headless
python legged_gym/scripts/play.py --task=elspider_air_rough --num_envs=48 --checkpoint=-1
```

---

## ElSpiderAir Rough RayCast

**简短解释：加入 RayCast 地形感知的粗糙地形训练，使机器人能提前“看到”地面高度，实现更安全稳定的跨越能力。**

```bash
python legged_gym/scripts/train.py --task=elspider_air_rough_raycast --num_envs=6144 --resume --headless
python legged_gym/scripts/play.py --task=elspider_air_rough_raycast --num_envs=8 --checkpoint=-1
```

---

python /home/hithcat/Code/tools/PegasusFlow/extended_legged_gym/legged_gym/legged_gym/scripts/train.py --task=el_mini_base_pose_adapt --num_envs=4096 --resume --headless

